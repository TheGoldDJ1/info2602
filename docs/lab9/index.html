
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Lab 9 - Application Server Deployment</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid="UA-154889698-2"
                  id="lab9"
                  title="Lab 9 - Application Server Deployment"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="Introduction" duration="0">
        <p class="image-container"><img style="width: 624.00px" src="img\45a6449e1ab8dc70.png"></p>
<h2 is-upgraded><strong>Heroku</strong></h2>
<p>Heroku is a cloud platform as a service supporting several programming languages. Heroku is one of the few multi-language platforms which can host application servers for free without a credit card!</p>
<p>We shall set up heroku to auto deploy our application using git. </p>
<h2 is-upgraded><strong>Task 1</strong></h2>
<p>First you need to fork the template repository into your github account. Start by following the link below.</p>
<p><a href="https://github.com/uwidcit/info2602ps" target="_blank"><paper-button class="colored" raised>Open Project Starter Repo</paper-button></a></p>
<p>Make sure you&#39;re logged into github then click the &#34;Fork&#34; button.</p>
<p class="image-container"><img style="width: 624.00px" src="img\128b59a712246c1.png"></p>
<p>After the fork is completed, you should now edit the gitpod link in your readme.md file to point to your repository</p>
<p class="image-container"><img style="width: 624.00px" src="img\5dd2698f40b9e7db.png"></p>
<p>Next, update the gitpod link in the readme to point to your repository&#39;s url which should look like</p>
<p><a href="https://github.com/" target="_blank">https://github.com/</a>&lt;username&gt;/info2602ps.git.</p>
<p class="image-container"><img style="width: 624.00px" src="img\eada2554e0860ccc.png"></p>
<p>Then click on the green &#34;Commit Changes&#34; button below to save the changes to the readme file.</p>
<p>Finally you can open your workspace by clicking on your gitpod button.</p>
<p class="image-container"><img style="width: 624.00px" src="img\77f359629b4e0fe1.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Creating a Heroku App" duration="0">
        <p>Before completing this step you need to <a href="https://signup.heroku.com/login" target="_blank">create a heroku account</a>. The heroku cli should already be installed in the workspace. </p>
<h2 is-upgraded><strong>Task 2</strong></h2>
<p>Now you can login in the cli using the following command.</p>
<pre>heroku login --interactive</pre>
<p>Next you want to create a heroku app by entering this command.</p>
<pre>heroku create</pre>
<p>The app should be created with a random name and can be seen on your <a href="https://dashboard.heroku.com/apps/" target="_blank">heroku dashboard</a>.</p>
<p>At this point your project should be linked to two git repositories, one for github and heroku. It is important to ensure that the heroku repository is linked when restarting the workspace. You can view the repositories with the command:</p>
<pre>git remote -v</pre>
<p>You should see links for github and heroku.</p>
<p class="image-container"><img style="width: 485.00px" src="img\9650a135b4566670.png"></p>
<aside class="special"><p>Note: If for some reason you need to reconnect your workspace to your heroku app you can run the following command.</p>
<p><code>heroku git:remote -a &lt;heroku-app-name&gt;</code></p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Pushing Changes To Git" duration="0">
        <h2 is-upgraded><strong>Task 3</strong></h2>
<p>Now try making a change to one of the templates.</p>
<p><code>templates/home.html</code></p>
<pre><code>{% extends &#34;layout.html&#34; %}
{% block title %}Backend App{% endblock %}
{% block page %}Backend App{% endblock %}

&#123;&#123; super() }}

{% block content %}
    &lt;h1&gt;Hello! This view is partially rendered on the server using jinja&lt;/h1&gt;
    &lt;h2&gt;It must be dynamically served&lt;/h2&gt;
{% endblock %}</code></pre>
<p>Next you want to save the changes to your github repository using the source control tab (3rd item in navigation on the left) in gitpod as shown below.</p>
<p class="image-container"><img style="width: 410.00px" src="img\4ab0ac58c2600b8b.gif"></p>
<p>In the diagram we:</p>
<ul>
<li>Created a commit message.</li>
<li>Staged all changes of our files.</li>
<li>Committed the changes.</li>
<li>Then push the changes.</li>
</ul>
<p>This pushes the changes to your gitpod repo.</p>
<h2 is-upgraded><strong>Task 4</strong></h2>
<p>To deploy to heroku you also need to push changes to heroku. So after a commit is made you can run the following command to push to the heroku repo.</p>
<pre>git push heroku master</pre>
<p>A successful commit should show something similar to the image below.</p>
<p class="image-container"><img style="width: 624.00px" src="img\fa1c8aa0a8186fc2.png"></p>
<p>You can then view your application by ctrl + click the link in the terminal or by viewing your heroku dashboard.</p>
<p class="image-container"><img style="width: 624.00px" src="img\c67470c2c9706565.png"></p>
<p>Clicking on your application.</p>
<p class="image-container"><img style="width: 624.00px" src="img\e565b3789c7a4ed9.png"></p>
<p> Then finally clicking &#34;Open App&#34;.</p>
<p class="image-container"><img style="width: 624.00px" src="img\97c735919c969982.png"></p>
<p>Your application server should be running on heroku!</p>


      </google-codelab-step>
    
      <google-codelab-step label="Postman Collections" duration="0">
        <p>Next we shall create and deploy a postman collection for our API. First add some routes to the application.</p>
<p><code>main.py</code></p>
<pre><code>@app.route(&#39;/data&#39;, methods=[&#39;GET&#39;])
def getData():
  token = request.args.get(&#39;token&#39;)
  res = &#39;Hello token=&#39;+token if token else &#34;Hello&#34;
  return res

@app.route(&#39;/data&#39;, methods=[&#39;POST&#39;])
def addData():
  data = request.json
  res = &#39;Hello data=&#39;+json.dumps(data) if data else &#34;Hello&#34;
  return res, 201

@app.route(&#39;/data/:id&#39;, methods=[&#39;DELETE&#39;])
def removeData(id):
  res = &#39;id &#39;+id+&#39; Deleted!&#39;
  return res, 204

@app.route(&#39;/data/:id&#39;, methods=[&#39;UPDATE&#39;])
def updateData(id):
  data = request.json
  res = &#39;id &#39;+id
  res += &#39; Hello data=&#39;+json.dumps(data) if data else &#34;Hello&#34;
  return res, 201

</code></pre>
<p>Stage and Commit the changes</p>
<p class="image-container"><img style="width: 334.00px" src="img\987830e4f85cb314.png"></p>
<p>Then push</p>
<p class="image-container"><img style="width: 491.00px" src="img\752bbf8a6058564b.png"></p>
<p>Now push to heroku with the following command.</p>
<pre>git push heroku master</pre>
<p>Now open postman and signup/login. Then create a new collection.</p>
<p class="image-container"><img style="width: 624.00px" src="img\a1796e6c479ed98b.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Creating Requests" duration="0">
        <p>Now the collection is created you can then create a new request by clicking the &#34;NEW&#34; button and entering the /data route on your application server&#39;s url.</p>
<p class="image-container"><img style="width: 624.00px" src="img\f5ba7a66c9ba7166.png"></p>
<p>Then click the SAVE button to save the request to the collection. Give the request a name and a description then save it to the current collection.</p>
<p class="image-container"><img style="width: 601.00px" src="img\aca3bed356b1dbd1.png"></p>
<p>Next create another request to the post route. Change the url to &lt;server&gt;/data. Change the method from GET to POST on the left of the url bar.</p>
<p>Then edit the body by clicking on the body tab, select &#34;raw&#34; in the radio list and set the dropdown to &#34;JSON&#34;.</p>
<p>You can then enter the post data in the text field below.</p>
<p class="image-container"><img style="width: 624.00px" src="img\eb3f6e86ff210a7d.png"></p>
<p>Press send then press save to save the request giving it a name and description.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Publishing The Collection" duration="0">
        <p>At this point you should have two requests in your collection. In the toolbar on the left click the menu button next to your collection then select. Publish Docs</p>
<p class="image-container"><img style="width: 359.00px" src="img\c178ce6ab45fde9a.png"></p>
<p>This should open a browser tab to Edit the Published Collection. Scroll to the bottom then click &#34;Publish Collection&#34; on the bottom of the page.</p>
<p class="image-container"><img style="width: 624.00px" src="img\df12ab43420c5bc2.png"></p>
<p>Your collection should be now published at the url given.</p>
<p class="image-container"><img style="width: 624.00px" src="img\21ac0941905185ba.png"></p>
<p>If you save more requests to your collection your doc site would be updated accordingly.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Conclusion" duration="0">
        <p>And that&#39;s how you can deploy a flask application on heroku and create a corresponding postman documentation for the server&#39;s endpoints.</p>
<h2 is-upgraded>References &amp; Additional Reading</h2>
<p><a href="https://devcenter.heroku.com/articles/git" target="_blank">Git Deployment with Heroku</a></p>
<p><a href="https://learning.postman.com/docs/postman/api-documentation/documenting-your-api/" target="_blank">Documenting APIs in Postman</a></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
